import cheerio from "cheerio";
import del from "del";
import eslexer from "es-module-lexer";
import fs from "fs";
import {bold, green, red, underline, yellow} from "kleur/colors";
import mime from "mime";
import path from "path";
import {performance} from "perf_hooks";
import glob from "tiny-glob";
import hash from "shorthash";
import {fileURLToPath} from "url";
import {bundleCSS} from "./build/bundle/css.js";
import {bundleJS, bundleHoistedJS, collectJSImports} from "./build/bundle/js.js";
import {buildStaticPage, getStaticPathsForPage} from "./build/page.js";
import {generateSitemap} from "./build/sitemap.js";
import {collectBundleStats, logURLStats, mapBundleStatsToURLStats} from "./build/stats.js";
import {getDistPath, stopTimer} from "./build/util.js";
import {debug, defaultLogDestination, defaultLogLevel, error, info, warn} from "./logger.js";
import {createRuntime} from "./runtime.js";
const defaultLogging = {
  level: defaultLogLevel,
  dest: defaultLogDestination
};
function isRemoteOrEmbedded(url) {
  return url.startsWith("http://") || url.startsWith("https://") || url.startsWith("//") || url.startsWith("data:");
}
async function build(astroConfig, logging = defaultLogging) {
  const {projectRoot} = astroConfig;
  const buildState = {};
  const depTree = {};
  const timer = {};
  const runtimeLogging = {
    level: "error",
    dest: defaultLogDestination
  };
  if (!astroConfig.buildOptions.site) {
    warn(logging, "config", `Set "buildOptions.site" to generate correct canonical URLs and sitemap`);
  }
  const mode = "production";
  const astroRuntime = await createRuntime(astroConfig, {mode, logging: runtimeLogging});
  const {runtimeConfig} = astroRuntime;
  const {snowpackRuntime} = runtimeConfig;
  try {
    await del(fileURLToPath(astroConfig.dist));
    timer.build = performance.now();
    info(logging, "build", yellow("! building pages..."));
    const allRoutesAndPaths = await Promise.all(runtimeConfig.manifest.routes.map(async (route) => {
      if (route.path) {
        return [route, [route.path]];
      } else {
        const result = await getStaticPathsForPage({
          astroConfig,
          astroRuntime,
          route,
          snowpackRuntime,
          logging
        });
        if (result.rss.xml) {
          if (buildState[result.rss.url]) {
            throw new Error(`[getStaticPaths] RSS feed ${result.rss.url} already exists.
Use \`rss(data, {url: '...'})\` to choose a unique, custom URL. (${route.component})`);
          }
          buildState[result.rss.url] = {
            srcPath: new URL(result.rss.url, projectRoot),
            contents: result.rss.xml,
            contentType: "text/xml",
            encoding: "utf8"
          };
        }
        return [route, result.paths];
      }
    }));
    try {
      await Promise.all(allRoutesAndPaths.map(async ([route, paths]) => {
        for (const p of paths) {
          await buildStaticPage({
            astroConfig,
            buildState,
            route,
            path: p,
            astroRuntime
          });
        }
      }));
    } catch (e) {
      if (e.filename) {
        let stack = e.stack.replace(/Object\.__render \(/gm, "").replace(/\/_astro\/(.+)\.astro\.js\:\d+\:\d+\)/gm, (_, $1) => "file://" + fileURLToPath(projectRoot) + $1 + ".astro").split("\n");
        stack.splice(1, 0, `    at file://${e.filename}`);
        stack = stack.join("\n");
        error(logging, "build", `${red(`Unable to render ${underline(e.filename.replace(fileURLToPath(projectRoot), ""))}`)}

${stack}
`);
      } else {
        error(logging, "build", e.message);
      }
      error(logging, "build", red("\u2715 building pages failed!"));
      await astroRuntime.shutdown();
      return 1;
    }
    info(logging, "build", green("\u2714"), "pages built.");
    debug(logging, "build", `built pages [${stopTimer(timer.build)}]`);
    timer.deps = performance.now();
    const scanPromises = [];
    await eslexer.init;
    for (const id of Object.keys(buildState)) {
      if (buildState[id].contentType !== "text/html")
        continue;
      const pageDeps = findDeps(buildState[id].contents, {
        astroConfig,
        srcPath: buildState[id].srcPath,
        id
      });
      depTree[id] = pageDeps;
      for (const url of [...pageDeps.js, ...pageDeps.css, ...pageDeps.images]) {
        if (!buildState[url])
          scanPromises.push(astroRuntime.load(url).then((result) => {
            if (result.statusCode !== 200) {
              if (result.statusCode === 404) {
                throw new Error(`${buildState[id].srcPath.href}: could not find "${url}"`);
              }
              throw result.error || new Error(`unexpected status ${result.statusCode} when loading ${url}`);
            }
            buildState[url] = {
              srcPath: new URL(url, projectRoot),
              contents: result.contents,
              contentType: result.contentType || mime.getType(url) || ""
            };
          }));
      }
    }
    await Promise.all(scanPromises);
    debug(logging, "build", `scanned deps [${stopTimer(timer.deps)}]`);
    info(logging, "build", yellow("! optimizing css..."));
    timer.prebundleCSS = performance.now();
    await Promise.all([
      bundleCSS({buildState, astroConfig, logging, depTree}).then(() => {
        debug(logging, "build", `bundled CSS [${stopTimer(timer.prebundleCSS)}]`);
      }),
      bundleHoistedJS({buildState, astroConfig, logging, depTree, runtime: astroRuntime, dist: astroConfig.dist})
    ]);
    info(logging, "build", green("\u2714"), "css optimized.");
    const urlStats = await collectBundleStats(buildState, depTree);
    const jsImports = await collectJSImports(buildState);
    if (astroConfig.buildOptions.sitemap && astroConfig.buildOptions.site) {
      timer.sitemap = performance.now();
      info(logging, "build", yellow("! creating sitemap..."));
      const sitemap = generateSitemap(buildState, astroConfig.buildOptions.site);
      const sitemapPath = new URL("sitemap.xml", astroConfig.dist);
      await fs.promises.mkdir(path.dirname(fileURLToPath(sitemapPath)), {recursive: true});
      await fs.promises.writeFile(sitemapPath, sitemap, "utf8");
      info(logging, "build", green("\u2714"), "sitemap built.");
      debug(logging, "build", `built sitemap [${stopTimer(timer.sitemap)}]`);
    }
    timer.write = performance.now();
    await Promise.all(Object.keys(buildState).map(async (id) => {
      const outPath = new URL(`.${id}`, astroConfig.dist);
      const parentDir = path.dirname(fileURLToPath(outPath));
      await fs.promises.mkdir(parentDir, {recursive: true});
      await fs.promises.writeFile(outPath, buildState[id].contents, buildState[id].encoding);
      delete buildState[id];
      delete depTree[id];
    }));
    debug(logging, "build", `wrote files to disk [${stopTimer(timer.write)}]`);
    if (fs.existsSync(astroConfig.public)) {
      info(logging, "build", yellow(`! copying public folder...`));
      timer.public = performance.now();
      const cwd = fileURLToPath(astroConfig.public);
      const publicFiles = await glob("**/*", {cwd, filesOnly: true});
      await Promise.all(publicFiles.map(async (filepath) => {
        const srcPath = new URL(filepath, astroConfig.public);
        const distPath = new URL(filepath, astroConfig.dist);
        await fs.promises.mkdir(path.dirname(fileURLToPath(distPath)), {recursive: true});
        await fs.promises.copyFile(srcPath, distPath);
      }));
      debug(logging, "build", `copied public folder [${stopTimer(timer.public)}]`);
      info(logging, "build", green("\u2714"), "public folder copied.");
    } else {
      if (path.basename(astroConfig.public.toString()) !== "public") {
        info(logging, "tip", yellow(`! no public folder ${astroConfig.public} found...`));
      }
    }
    info(logging, "build", yellow(`! bundling...`));
    if (jsImports.size > 0) {
      timer.bundleJS = performance.now();
      const jsStats = await bundleJS(jsImports, {dist: astroConfig.dist, astroRuntime});
      mapBundleStatsToURLStats({urlStats, depTree, bundleStats: jsStats});
      debug(logging, "build", `bundled JS [${stopTimer(timer.bundleJS)}]`);
      info(logging, "build", green(`\u2714`), "bundling complete.");
    }
    logURLStats(logging, urlStats);
    await astroRuntime.shutdown();
    info(logging, "build", bold(green("\u25B6 Build Complete!")));
    return 0;
  } catch (err) {
    error(logging, "build", err.message);
    await astroRuntime.shutdown();
    return 1;
  }
}
function findDeps(html, {astroConfig, srcPath}) {
  const pageDeps = {
    js: new Set(),
    css: new Set(),
    images: new Set(),
    hoistedJS: new Map()
  };
  const $ = cheerio.load(html);
  $("script").each((_i, el) => {
    const src = $(el).attr("src");
    const hoist = $(el).attr("data-astro") === "hoist";
    if (hoist) {
      if (src) {
        pageDeps.hoistedJS.set(src, {
          src
        });
      } else {
        let content = $(el).html() || "";
        pageDeps.hoistedJS.set(`astro-virtual:${hash.unique(content)}`, {
          content
        });
      }
    } else if (src) {
      if (isRemoteOrEmbedded(src))
        return;
      pageDeps.js.add(getDistPath(src, {astroConfig, srcPath}));
    } else {
      const text = $(el).html();
      if (!text)
        return;
      const [imports] = eslexer.parse(text);
      for (const spec of imports) {
        const importSrc = spec.n;
        if (importSrc && !isRemoteOrEmbedded(importSrc)) {
          pageDeps.js.add(getDistPath(importSrc, {astroConfig, srcPath}));
        }
      }
    }
  });
  $("link[href]").each((_i, el) => {
    const href = $(el).attr("href");
    if (href && !isRemoteOrEmbedded(href) && ($(el).attr("rel") === "stylesheet" || $(el).attr("type") === "text/css" || href.endsWith(".css"))) {
      const dist = getDistPath(href, {astroConfig, srcPath});
      pageDeps.css.add(dist);
    }
  });
  $("img[src]").each((_i, el) => {
    const src = $(el).attr("src");
    if (src && !isRemoteOrEmbedded(src)) {
      pageDeps.images.add(getDistPath(src, {astroConfig, srcPath}));
    }
  });
  $("img[srcset]").each((_i, el) => {
    const srcset = $(el).attr("srcset") || "";
    const sources = srcset.split(",");
    const srces = sources.map((s) => s.trim().split(" ")[0]);
    for (const src of srces) {
      if (!isRemoteOrEmbedded(src)) {
        pageDeps.images.add(getDistPath(src, {astroConfig, srcPath}));
      }
    }
  });
  return pageDeps;
}
export {
  build,
  findDeps
};
//# sourceMappingURL=data:application/json;base64,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
