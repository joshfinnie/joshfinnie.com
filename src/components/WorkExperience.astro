---
import CloudinaryImage from './CloudinaryImage.astro';
import { Card, CardFooter, CardTitle } from './ui/card';

interface Props {
  company: string;
  role: string;
  startDate: string;
  endDate?: string | undefined;
  logo: string;
}

const { company, role, startDate, endDate = null, logo } = Astro.props;

// Convert logo filename to Cloudinary public ID (e.g., "logo.png" -> "companies/logo")
const publicId = `companies/${logo.replace(/\.(jpg|jpeg|png|gif)$/i, '')}`;
---

<Card
  className="flex flex-col items-start p-4 bg-white dark:bg-zinc-800 shadow-lg border border-zinc-200 dark:border-zinc-700 rounded-lg"
>
  <div class="flex items-center gap-4 mb-4">
    <div
      class="relative flex h-10 w-10 items-center justify-center rounded-full shadow-md shadow-zinc-800/5 ring-1 ring-zinc-900/5 dark:border dark:border-zinc-700/50 dark:bg-zinc-800 dark:ring-0"
    >
      <CloudinaryImage publicId={publicId} alt={company} width={40} height={40} class="h-10 w-10" />
    </div>
    <div class="flex flex-col">
      <CardTitle className="text-sm font-medium text-zinc-900 dark:text-zinc-100">{company}</CardTitle>
      <p class="text-xs text-zinc-500 dark:text-zinc-400">{role}</p>
    </div>
  </div>
  <CardFooter className="text-xs text-zinc-400 dark:text-zinc-500 p-0">
    <time datetime={startDate}>
      {new Date(`${startDate}-15`).toLocaleDateString("en-US", { year: "numeric", month: "long" })}
    </time>{" "}
    -{" "}
    {
      endDate ? (
        <time datetime={endDate}>
          {new Date(`${endDate}-15`).toLocaleDateString("en-US", { year: "numeric", month: "long" })}
        </time>
      ) : (
        "Present"
      )
    }
  </CardFooter>
</Card>
